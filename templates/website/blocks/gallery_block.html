{# Block: Gallery con filtri categoria #}
<section class="gallery-section py-16 bg-white" aria-labelledby="gallery-heading-{{ id }}">
    <div class="max-w-7xl mx-auto px-6">
        {% if value.title %}
        <h2 id="gallery-heading-{{ id }}" class="text-4xl font-heading font-black text-navy text-center mb-8" data-aos="fade-up">
            {{ value.title }}
        </h2>
        {% endif %}
        
        {% if value.show_filters %}
        <!-- Category Filters -->
        <div class="flex flex-wrap justify-center gap-4 mb-12" data-aos="fade-up" role="tablist" aria-label="{{ _('Filtra galleria per categoria') }}">
            <button class="gallery-filter px-6 py-3 rounded-full font-bold transition bg-navy text-white" 
                    data-category="all" 
                    role="tab" 
                    aria-selected="true">
                <i class="fas fa-images mr-2" aria-hidden="true"></i> {{ _('Tutti') }}
            </button>
            <button class="gallery-filter px-6 py-3 rounded-full font-bold transition bg-warm-gray text-navy hover:bg-navy hover:text-white" 
                    data-category="raduni" 
                    role="tab" 
                    aria-selected="false">
                <i class="fas fa-users mr-2" aria-hidden="true"></i> {{ _('Raduni') }}
            </button>
            <button class="gallery-filter px-6 py-3 rounded-full font-bold transition bg-warm-gray text-navy hover:bg-navy hover:text-white" 
                    data-category="escursioni" 
                    role="tab" 
                    aria-selected="false">
                <i class="fas fa-mountain mr-2" aria-hidden="true"></i> {{ _('Escursioni') }}
            </button>
            <button class="gallery-filter px-6 py-3 rounded-full font-bold transition bg-warm-gray text-navy hover:bg-navy hover:text-white" 
                    data-category="gare" 
                    role="tab" 
                    aria-selected="false">
                <i class="fas fa-trophy mr-2" aria-hidden="true"></i> {{ _('Gare') }}
            </button>
            <button class="gallery-filter px-6 py-3 rounded-full font-bold transition bg-warm-gray text-navy hover:bg-navy hover:text-white" 
                    data-category="sociali" 
                    role="tab" 
                    aria-selected="false">
                <i class="fas fa-glass-cheers mr-2" aria-hidden="true"></i> {{ _('Eventi Sociali') }}
            </button>
        </div>
        {% endif %}
        
        <!-- Gallery Grid -->
        <div class="grid grid-cols-2 md:{{ value.columns }} gap-4">
            {% for item in value.images %}
            <div class="gallery-item group relative overflow-hidden rounded-xl cursor-pointer card-hover" 
                 data-category="{{ item.category|default:'all' }}"
                 onclick="openLightbox('{{ image(item.image, 'width-1200').url }}', '{{ item.caption|default:'' }}')"
                 data-aos="fade-up" 
                 data-aos-delay="{{ forloop.counter }}00">
                <div class="aspect-square overflow-hidden">
                    <img src="{{ image(item.image, 'fill-400x400').url }}" 
                         alt="{{ item.caption or _('Foto galleria') }}" 
                         class="w-full h-full object-cover transform group-hover:scale-110 transition duration-500">
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-navy/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    {% if item.caption %}
                    <div class="absolute bottom-4 left-4 right-4">
                        <p class="text-white text-sm">{{ item.caption }}</p>
                    </div>
                    {% endif %}
                    <div class="absolute top-4 right-4">
                        <span class="bg-gold text-navy px-2 py-1 rounded-full text-xs font-bold">
                            <i class="fas fa-search-plus" aria-hidden="true"></i>
                        </span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

{% if value.show_filters %}
<script>
(function() {
    const filterBtns = document.querySelectorAll('.gallery-filter');
    const items = document.querySelectorAll('.gallery-item');
    
    filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const category = btn.dataset.category;
            
            // Update active state
            filterBtns.forEach(b => {
                b.classList.remove('bg-navy', 'text-white');
                b.classList.add('bg-warm-gray', 'text-navy');
                b.setAttribute('aria-selected', 'false');
            });
            btn.classList.remove('bg-warm-gray', 'text-navy');
            btn.classList.add('bg-navy', 'text-white');
            btn.setAttribute('aria-selected', 'true');
            
            // Filter items
            items.forEach(item => {
                const itemCategory = item.dataset.category;
                if (category === 'all' || itemCategory === category) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        });
    });
})();
</script>
{% endif %}

